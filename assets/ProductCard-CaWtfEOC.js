import{j as e,r,c as F,a as I,d as T,L as E}from"./index-CTOY4OMw.js";function L({children:o}){return e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-[repeat(auto-fit,minmax(300px,1fr))] gap-x-4 gap-y-10 my-8  mx-auto justify-items-center",children:o})}function W({product:o}){const{id:a,title:x,price:c,images:j,rating:w,discountPercentage:l,category:v,stock:t}=o,{user:m,isAuthenticated:u}=F(),{addCart:N,addProductWish:C,carts:g,wishList:h}=I(),[f,p]=r.useState(!1),[b,y]=r.useState(!1),[P,k]=r.useState(!1),n=T(),d=r.useMemo(()=>g.some(s=>s.products?.some($=>$.id===a)),[g,a]),i=r.useMemo(()=>h.some(s=>s.id===a),[h,a]);async function A(){if(!m?.id){n("/login");return}if(!u){n("/login");return}if(!d){y(!0);try{await N({userId:m.id,products:[{id:o.id,quantity:1}]})}catch(s){console.error("Failed to add cart:",s),alert("Something went wrong. Please try again.")}finally{y(!1)}}}async function S(){if(!m?.id){n("/login");return}if(!u){n("/login");return}if(!i){p(!0);try{await C(a)}catch(s){console.error("Failed to add to wishlist:",s),alert("Something went wrong. Please try again.")}finally{p(!1)}}}return e.jsxs("div",{className:"flex flex-col gap-3 group bg-white border border-gray-100 p-4 rounded-xl shadow-sm hover:shadow-lg transition-all duration-300 w-full hover:-translate-y-1",children:[e.jsxs("div",{className:"relative overflow-hidden rounded-lg bg-gray-50",children:[l>0&&e.jsxs("span",{className:"absolute top-3 left-3 bg-gradient-to-r from-red-500 to-orange-500 text-white text-xs font-bold px-2 py-1 rounded-full shadow-md z-10",children:["-",l,"%"]}),e.jsx("span",{className:`absolute top-3 right-3 text-xs font-bold px-2 py-1 rounded-full shadow-md z-10 ${t>10?"bg-green-100 text-green-800":t>0?"bg-amber-100 text-amber-800":"bg-red-100 text-red-800"}`,children:t>10?"In Stock":t>0?`Only ${t} left`:"Out of Stock"}),e.jsx("div",{className:"h-56 flex items-center justify-center p-4",children:e.jsx("img",{src:P?"https://via.placeholder.com/250x250?text=Product+Image":j?.[0]||"https://via.placeholder.com/250",alt:x,onError:()=>k(!0),className:"max-h-full max-w-full object-contain transition-transform duration-500 group-hover:scale-110"})}),e.jsxs("div",{className:"absolute bottom-3 left-0 right-0 flex justify-center gap-2 opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:[e.jsx("button",{onClick:A,disabled:b||t===0||d,className:`flex items-center justify-center gap-1 h-10 px-4 rounded-full text-sm font-semibold transition-all duration-300 shadow-md ${d?"bg-green-600 text-white":t===0?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,children:b?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"material-symbols-outlined text-base animate-spin",children:"progress_activity"}),"Adding..."]}):d?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"material-symbols-outlined text-base",children:"check"}),"Cart Added"]}):t===0?"Out of Stock":e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"material-symbols-outlined text-base",children:"shopping_cart"}),"Add to Cart"]})}),e.jsx("button",{onClick:S,disabled:f||i,className:`h-10 w-10 flex items-center justify-center rounded-full transition-colors duration-300 shadow-md ${i?"bg-red-600 text-white":"bg-white text-gray-700 hover:bg-red-50 hover:text-red-500"}`,children:f&&!i?e.jsx("span",{className:"material-symbols-outlined text-lg animate-spin",children:"progress_activity"}):e.jsx("span",{className:"material-symbols-outlined text-lg",children:i?"favorite":"favorite_border"})})]})]}),e.jsxs("div",{className:"p-1 flex flex-col gap-2",children:[e.jsx("span",{className:"text-xs font-medium text-blue-600 uppercase tracking-wide",children:v}),e.jsx("h3",{className:"text-gray-900 text-lg font-semibold line-clamp-2 leading-tight hover:text-blue-600 transition-colors h-14",children:x}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center bg-amber-50 px-2 py-1 rounded",children:[e.jsx("span",{className:"material-symbols-outlined text-amber-500 text-base",children:"star"}),e.jsx("span",{className:"text-amber-700 text-sm font-bold ml-1",children:w})]}),e.jsxs("div",{className:"flex items-center gap-2 ml-auto",children:[l>0&&e.jsxs("span",{className:"text-gray-400 text-sm line-through",children:["$",(c+c*l/100).toFixed(2)]}),e.jsxs("span",{className:"text-xl font-bold text-gray-900",children:["$",c]})]})]}),e.jsxs(E,{className:"flex items-center justify-between mt-2 text-blue-600 hover:text-blue-800 font-medium transition-colors pt-2 border-t border-gray-100",to:`/productDetails/${a}`,children:[e.jsx("span",{children:"View Details"}),e.jsx("span",{className:"material-symbols-outlined text-base",children:"arrow_forward"})]})]})]})}const O=r.memo(W);export{L as P,O as a};
